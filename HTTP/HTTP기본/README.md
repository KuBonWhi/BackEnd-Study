# HTTP 기본

## HTTP

- 문서간에 링크를 통해 연결할 수 있는 프로토콜. 하지만 이제는 문서뿐 아니라 HTTP 메세지에 모든 것을 전송함.

## HTTP의 역사

- HTTP/0.9 1991년: GET 메서드만 지원, HTTP 헤더 X
- HTTP/1.0 1996년: 메서드, 헤더 추가
- HTTP/1.1 1997년: 가장 많이 사용하며, 우리에게 가장 중요한 버전
- HTTP/2 2015년: 성능 개선
- HTTP/3 진행중: TCP 대신에 UDP 사용, 성능 개선

## 기반 프로토콜

- TCP
  - HTTP/1.1, HTTP/2는 TCP 기반으로 동작
- UDP
  - HTTP/3
- 현재
  - HTTP/1.1을 주로 사용. HTTP/2, HTTP/3도 점차 증가.

### 왜 HTTP/3는 UDP 기반일까?

- 기존 TCP는 3 way hanshake부터 내부적으로 포함하거나 추가해야하는 작업들이 너무 많아서 신뢰성이나 연결성은 보장되지만 속도가 떨어진다. 그렇기에 UDP프로토콜을 애플리케이션 레벨에서 재설계를 해서 나오는게 HTTP/3이다.

## HTTP 특징

- 클라이언트 서버 구조로 동작
- 무상태 프로토콜(stateless), 비연결성
- HTTP 메세지를 통해 통신을 함(송/수신 모두)
- 단순함, 확장 가능

### 1. 클라이언트 서버 구조

- HTTP는 클라이언트가 HTTP 메세지를 만들어 보내고 , 서버에서 요청에 대한 응답이 올 때까지 기다린다.
- 왜 클라이언트와 서버를 분리해야 될까?
  - 각자의 역할에 집중할 수 있다.
    - 클라이언트에서는 복잡한 비즈니스 로직이나 데이터를 다룰 필요없고, UI에 집중할 수 있다.
    - 서버에서는 복잡한 비즈니스 로직이나 데이터를 다루는 데만 집중하면 된다.

### 2. Stateful, Stateless

- Stateful(상태 유지)
  - 서버가 클라이언트의 상태를 보존한다.
  - 즉, 클라이언트와 서버간에 송/수신을 하며 단계별 과정을 진행하는데 서버에서 클라이언트가 이전 단계에서 제공한 값을 저장하고 다음 단계에서도 저장한 상태
  - 여러 이유로 해당 서버가 못쓰게되서 다른 서버를 사용해야 한다면 새로운 서버에서는 이전 서버에서 가지고 있던 상태값들을 가지고 있지 않기 때문에 에러가 발생

### 3. Stateless(무상태)

- 서버가 클라이언트의 상태를 보존하지 않는다.
- 그렇기에 매번 요청에 모든 상태값들을 전달해야 한다.
- 스케일 아웃(수평 확장에 유리, 여러 서버)

### 정리

- 상태 유지
  - 중간에 서버가 변경되면 안된다.
    - 만약 서버가 변경되야 한다면 상태 정보를 다른 서버에게 미리 알려줘야 한다.
- 무상태
  - 중간에 서버가 변경되도 된다.
    - 클라이언트가 폭증해도 서버를 대거 늘릴 수 있다.
- 무상태는 응답 서버를 변경하기가 귑기에 서버 증설이 쉽다.

### 무상태의 실무 한계

- 모든것을 무상태로 설계가 가능한 경우도 있고 없는 경우도 있다.
- 무상태
  - 로그인이 필요 없는 단순한 이벤트 페이지
- 상태 유지
  - 로그인을 해야하는 경우
- 로그인한 사용자의 경우 해당 상태를 서버에 유지해야 한다.
- 일반적으로 브아루저 쿠키와 서버 세션등을 사용해 상태를 유지한다.
- 상태 유지는 최소한으로만 사용한다.
- 보내야 하는 데이터가 너무 많다.
  - 매번 요청에 필요한 데이터를 전부 작성해야 하기 때문

### 3. 비연결성

- TCP/IP는 연결을 유지하는 모델
  - 클라이언트1이 서버와 연결을 한 뒤 클라이언트 2에서 서버와 연결을 할 때도 클라이언트 1과 서버는 연결을 유지하고 있다. (이는 클라이언트 3의경우도 마찮가지다.
- 연결을 유지하진 않는 모델
  - 클라이언트별로 서버와 연결을 유지하지 않을경우 필요할때만 연결을 하며 그외에는 연결을 유지하지 않기 때문에 서버에서 사용해야 하는 자원이 훨씬 줄어든다.

### HTTP의 비연결성

- HTTP의 기본이 연결을 유지하지 않는 모델이다.
- 일반적으로 초 단위 이하의 빠른 속도로 응답한다.
- 1시간동안 수천명 이상이 서비스를 사용해도 실제 서버에서 동시에 처리하는 요청은 수십개 이하로 적다.
- 서버 자원을 매우 효율적으로 사용할 수 잇다.

### 비연결성의 한계와 극복

- 매번 새로 연결해야한다는것은 매 연결마다 들어가는 비용에 대해서 고려해야 된다.
  - TCP/IP 연결을 새로 맺어야 한다.
    - 3-way-handshake 시간 추가
  - 웹 브라우저로 사이트를 요청하면 HTML 뿐 아니라 JavaScript, CSS, Image등 수많은 자원들을 함께 다운로드함.
  - 지금은 HTTP 지속 연결로 문제를 해결한다.
  - HTTP/2, HTTP/3에서 더 많은 최적화.
