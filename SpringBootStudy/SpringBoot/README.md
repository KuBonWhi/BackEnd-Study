# 스프링이란?

- 스프링은 IOC(Inversion Of Control) 컨테이너를 가진다.

## 1. IOC(Inversion Of Control)

- 제어권의 역전
- 메소드나 객체의 호출작업을 개발자가 정하는 것이 아니라, 외부에서 결정되는 것.
- 의존성을 역전시켜 객체 간의 결합도를 줄이고 유연한 코드를 작성할 수 있게 함
  - 가독성 및 코드 중복을 줄이고, 유지 보수를 편하게 함
- 기존 vs 스프링
  - 기존
    - 1. 객체 생성
    - 2. 의존성 객체 생성
      - 클래스 내부에서 생성
    - 3. 의존성 객체 메소드 호출
  - 스프링
    - 1. 객체 생성
    - 2. 의존성 객체 주입
      - 제어권을 스프링에게 위임하여 스프링이 만들어 놓은 객체를 주입
    - 3. 의존성 객체 메소드 호출
- 스프링이 모든 의존성 객체를 스프링이 실행될때 다 만들어 주고 필요한 곳에 주입. Bean들은 '싱글턴 패턴'의 특징을 가짐

## 2. DI(Dependency Injection)

- DI란 스프링이 다른 프레임워크와 차별화되어 제공하는 의존 관계 주입 기능
- 객체를 직접 생성하는 것이 아니라 외부에서 생성한 후 주입 시켜주는 방식
- DI를 통해서 모듈 간의 결합도가 낮아지고 유연성이 높아진다.
- 의존성 주입의 예시
  - 외부에서 생성 된 객체를 setter()를 통해 사용하는 방법
  - A 객체에서 B, C 객체를 사용(의존)할 때, A 객체에서 직접 생성하는 것이 아니라 외부(IOC 컨테이너)에서 생성된 B, C 객체를 조립(주입)시켜 setter 혹은 생성자를 통해 사용하는 방식

## 3. Bean

- 스프링에서는 객체를 Bean이라고 부르며, 프로젝트가 실행될 때 사용자가 Bean으로 관리한느 객체들의 생성과 소멸에 관련된 작업을 자동적으로 수행해주는데 객체가 생성되는 곳을 스프링에서는 Bean 컨테이너라고 부른다.

## 4. 스프링에서의 싱글톤 패턴

### 싱글톤 패턴

- 클래스의 인스턴스가 딱 1개만 생성되는 것을 보장
- 해당되는 인스턴스에 대해서 static을 통해 최초 1번만 메모리를 할당시키며 이후 해당 인스턴스에 대한 호출이 생길 때마다 최초로 생긴 인스턴스를 사용한다.
- Private를 사용해 객체 인스턴스를 2개 이상 생성하지 못하도록 막는다
- 단점
  - 싱글톤 패턴을 사용하는 다른 객체들간의 결합도(의존성)이 높아지기 때문에 좋지 않다.
  - 내부 설계를 변경하거나 초기화하기 어렵다
  - private 생성자를 사용하기 때문에 자식 클래스를 만들기 어렵다
  - 유연하지 않다

### 싱글톤 컨테이너(스프링 컨테이너)

- 스프링 컨테이너는 객체 인스턴스를 싱글톤으로 관리한다
- 스프링 빈이 싱글톤 패턴으로 관리된다
- 객체 인스턴스를 1개만 생성 관리함
- 스프링 빈은 항상 무상태로 설계해야 됨 => 인스턴스를 공유하기 때문에 상태 변화가 일어나면 안됨

## 5. 필터

- 스프링의 독자적인 기능이 아닌 자바 서블릿에서 제공하는 기능.
- 스프링 프레임워크에서 필터로 인증 등 다양한 작업을 함.
- 필터는 요청이 DispatcherServlet에 의해 다뤄지기 전, 후에 동작.
  - 스프링 프레임워크는 들어온 요청이 DispatcherServlet에 의해 컨트롤러에 매핑
- Filter는 FilterChain(필터 체인)을 통해 여러 필터가 연쇄적으로 동작
  - 요청 <-> 필터 <-> 필터 <-> 필터 <-> 자원

### 어디에 쓰이나?

- 주로 요청에 대한 인증, 권한 체크 등을 하는데에 쓰임
- 들어온 요청이 DispatcherServlet에 전달되기 전에 헤더를 검사해 인증 토큰이 있는지 없는지, 올바른지 올바르지 않은지 등을 검사

## 6. 스프링 어노테이션

- 어노테이션은 컴파일러가 읽고 지나가는 주석
- 스프링에서는 주로 객체 생성을 하기 위해 사용됨

### 스프링의 주요 어노테이션

|   어노테이션   | 설명                                                                                                                                                                                                                                                                                                                    |
| :------------: | :---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| @Configuration | 이 어노테이션을 단 클래스는 빈 설정을 담당하는 클래스가 된다. 이 클래스 안에서 @Bean 어노테이션이 동봉된 메소드를 선언하면, 그 메소드를 통해 스프링 빈을 정의하고 생명주기를 설정하게 된다.                                                                                                                             |
| @ComponentScan | @Configuration 어노테이션과 함께 쓰면, 이 클래스는 자바 빈 설정 클래스이며, 이 @ComponentScan 어노테이션에서 제공하는 package 속성을 통해 스프링 빈 범위를 정의할 수 있다.                                                                                                                                              |
|    @Import     | @Configuration 어노테이션이 선언된 스프링 설정 클래스를 가져온다. 이게 있으면 빈 선언 시 실행 순서도 보장되기 때문에 가끔 튀어나오는 빈 선언 오류도 막을 수 있다.                                                                                                                                                       |
|   @Component   | (자주 씀) 빈을 선언하는 클래스를 작성하기 위해 넣는 어노테이션이다. @ComponentScan 의 주요 스캔 대상이다.                                                                                                                                                                                                               |
|    @Service    | @Component 어노테이션과 비슷. 데이터를 가지고 있지 않고 비지니스 로직만을 가지고 있을 때가 차이점                                                                                                                                                                                                                       |
|   @Autowired   | (자주 씀) 필드, 메소드, 생성자에다가 넣을 수 있다. 스프링 빈을 가져오는 가장 기본적인 방법이다.                                                                                                                                                                                                                         |
|     @Bean      | 이 어노테이션이 선언된 메소드는 리턴 타입을 가진 스프링 빈을 뱉는다. 싱글톤 빈에 대한 새 인스턴스를 가져오려고 할 때 사용한다.                                                                                                                                                                                          |
|    @Primary    | 기본 빈 요소를 정의할 때 사용한다. 만약 같은 클래스로 여러 개의 빈을 설정했을 때, 이 어노테이션을 추가로 달면, @Autowired 어노테이션을 통해 빈을 주입 시 이 어노테이션을 가진 빈을 우선적으로 가져온다.                                                                                                                 |
|   @Required    | 일반적인 빈 클래스를 초기화 시, 반드시 설정(setter)해야 하는 setter 메소드를 정의할 때 사용한다.                                                                                                                                                                                                                        |
|     @Value     | 생성자, setter 따위의 메소드, 필드 등에다가 스프링에서 설정한 값을 주입할 수 있다.                                                                                                                                                                                                                                      |
|   @DependsOn   | @Bean 및 @Component 등에 정의 및 선언한 빈 생성 시 요구되는 다른 빈을 정의할 때 사용한다. 이 어노테이션을 달면, 이 어노테이션에서 설정한 빈이 등록되지 전까지 어노테이션이 달린 빈을 선언하지 않게 된다. @Import 어노테이션이 클래스 단위 종속성 관리라면, @DependsOn 어노테이션은 빈 단위의 종속성 관리라고 보면 된다. |
|     @Lazy      | 이 어노테이션을 선언한 빈이나 빈 getter 및 필드는 다른 빈처럼 스프링 시작 시 빈 초기화를 하는 것이 아닌, 처음 가져올 때 빈 초기화를 하게 된다.                                                                                                                                                                          |
|     @Scope     | 빈의 생명 주기를 설정한다.                                                                                                                                                                                                                                                                                              |
|    @Profile    | 이 어노테이션이 달린 빈은 특정 프로필에서만 동작하도록 설정할 수 있다.                                                                                                                                                                                                                                                  |

### Spring Boot 어노테이션

|        어노테이션        | 설명                                                                                                                                                                                             |
| :----------------------: | :----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
|  @SpringBootApplication  | 스프링 부트는 기본적으로 이 어노테이션 기준으로 동작하도록 되어 있다. 스프링에서 필수적인 초기화를 담당하는 @EnableAutoConfiguration, @ComponentScan, @Configuration 어노테이션이 함축되어 있다. |
| @EnableAutoConfiguration | 스프링 부트의 핵심 어노테이션으로 웬만한 것들을 자동 설정하여 돌아가게 만들어주는 어노테이션이다.                                                                                                |
